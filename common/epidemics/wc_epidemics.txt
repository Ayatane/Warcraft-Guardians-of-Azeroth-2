undead_plague = {
	trait = undead_plague
	color = black
	priority = 10

	shader_data = {
		strength = 0.8
		edge_fade = 0.4
		tile_multiplier = 0.005
		texture_index = 0
		channel = red
	}

	name = {
		desc = epidemic_undead_scourge
	}
	
	on_start = {
		set_global_variable = {
			name = undead_scourge
			value = root
		}
		# LEGITIMACY LOSS FROM EPIDEMIC OUTBREAK
		epidemic_outbreak_legitimacy_effect = { PROVINCE = root.outbreak_province }
	}

	on_end = {
		remove_global_variable = undead_scourge
	}
	
	on_monthly = {
		trigger_event = {
			on_action = epidemic_ongoing_events
		}
	}

	character_infection_chance = {
		value = character_infection_chance_default_value
		multiply = 0.02 #The only way we can make it not kill every single character in the game
	}

	can_infect_character = {
		can_contract_disease_trigger = { DISEASE = undead_plague }
		immune_to_epidemic = { EPIDEMIC = scope:epidemic }
	}

	on_character_infected = {
		contract_disease_notify_effect = { DISEASE = undead_plague }
	}

	infection_levels = {
		5 = {
			province_modifier = {
				monthly_county_control_decline_add = -0.6
				development_decline = -3
				levy_reinforcement_rate = -0.3
				levy_size = -0.25
				supply_limit_mult = -0.2
				county_opinion_add = -10
				epidemic_travel_danger = 25
			}	
		}
		40 = {
			province_modifier = {
				monthly_county_control_decline_add = -0.8
				development_decline = -6
				levy_reinforcement_rate = -0.5
				levy_size = -0.4
				supply_limit_mult = -0.5
				county_opinion_add = -25
				epidemic_travel_danger = 40
			}	
		}
		70 = {
			province_modifier = {
				monthly_county_control_decline_add = -0.8
				development_decline = -8
				levy_reinforcement_rate = -1
				levy_size = -0.5
				supply_limit_mult = -1
				county_opinion_add = -25
				epidemic_travel_danger = 60
			}
		}
	}

	outbreak_intensities = {
		apocalyptic = {
			notification = {
				global = yes
				holder_event = ""
				liege_event = ""
				realm_event = ""
			}
			
			outbreak_chance = {
				value = 0
			}
			spread_chance = {
				value = spread_chance_epidemics_default_value
				multiply = spread_chance_epidemics_mult_value				
			}
			max_provinces = { 325 375 }

			infection_duration = {
				months = { 24 48 }
			}
			
			infection_progress_duration = {
				days = { 5 9 }
			}

			infection_recovery_duration = {
				days = { 80 120 }
			}
		}
	}
	
	#on_province_infected = {
	#	county = {
	#		apply_infection_development_loss = { BASE = 10 }
	#	}
	#	every_player = {
	#		if = {
	#			limit = {
	#				NOR = {
	#					any_owned_story = {
	#						story_type = story_cycle_black_death
	#					}
	#					has_character_flag = black_death_splash #black plague is in your realm
	#				}
	#			}
	#			create_story = story_cycle_black_death
	#			trigger_event = { #time-based fallback to notify the players that the black death is here.
	#				id = epidemic_events.5999
	#				years = { 4 6 } #Average time for Black Death to move from Siberia to Europe
	#			}
	#		}
	#	}
	#}
	
	on_province_recovered = {
		county = {
			remove_isolated_capital_modifiers_effect = yes
		}
	}
}