#need to look at gui and see if it has to be redone

open_professions_sgui = {
	scope = character

	effect = {
		if = { limit = { NOT = { exists = var:known_reagents_count } }
			set_variable = {
				name = known_reagents_count
				value = 0
			}
		}
		if = {
			limit = { NOT = { exists = global_var:mining_reagents_done } }
			init_mining_reagents_effect = yes
		}
	}
}

save_profession_sgui = {
	scope = character
	saved_scopes = { selected_profession }
	effect = {
		switch = {
			trigger = scope:selected_profession
			flag:Mining = {
				create_story = mining_story_cycle
			}
		}
	}
}

remove_profession_sgui = {
	scope = character
	saved_scopes = { selected_profession }
	effect = {
		switch = {
			trigger = scope:selected_profession
			flag:Mining = {
				random_owned_story = {
					limit = { story_type = mining_story_cycle }
					end_story = yes
				}
			}
		}
	}
}

close_current_view_sgui = {
	scope = character
	effect = {
		if = {
			limit = { has_variable_list = current_view_list }
			clear_variable_list = current_view_list
		}
	}
}

sell_reagent_sgui = {
	scope = character
	saved_scopes = { reagent }
	effect = {
		effect_for_scoped_reagent = {
			REAGENT = scope:reagent
			EFFECT = sell_reagent_effect 
		}
	}
}

set_reagent_commerce_sgui = {
	scope = character
	saved_scopes = { commerce }
	effect = {
		switch = {
			trigger = scope:commerce
			flag:ore = {
				set_variable = {
					name = commerce_type
					value = flag:ore
				}
			}
			flag:bar = {
				set_variable = {
					name = commerce_type
					value = flag:bar
				}
			}
		}
	}
}

smelt_reagent_sgui = {
	scope = character
	saved_scopes = { reagent }
	effect = {
		effect_for_scoped_reagent = {
			REAGENT = scope:reagent
			EFFECT = smelt_reagent_effect 
		}
	}
}

batch_start_sgui = {
	scope = character

	effect = {
		set_variable = {
			name = batch_amount
			value = 0
		}
	}
}

add_batch_sgui = {
	scope = character
	effect = {
		change_variable = {
			name = batch_amount
			add = 1
		}
	}
}

remove_batch_sgui = {
	scope = character
	effect = {
		change_variable = {
			name = batch_amount
			add = -1
		}
	}
}

add_ore_batch_sgui = {
	scope = character
	effect = {
		change_variable = {
			name = batch_amount
			add = 5
		}
	}
}

remove_ore_batch_sgui = {
	scope = character
	effect = {
		change_variable = {
			name = batch_amount
			add = -5
		}
	}
}

### DEBUG ###
discover_or_add_reagent_sgui = {
	scope = character
	saved_scopes = { reagent }
	effect = {
		effect_for_scoped_reagent = {
			REAGENT = scope:reagent
			EFFECT = discover_or_add_reagent_effect 
		}
	}
}

add_items_made_sgui = {
	scope = character
	saved_scopes = { profession }
	effect = {
		switch = {
			trigger = scope:profession
			flag:Mining = {
				change_variable = {
					name = Mining_items_made
					add = 1
				}
			}
			flag:Blacksmithing = {
				change_variable = {
					name = Blacksmithing_items_made
					add = 1
				}
			}
		}
	}
}

remove_items_made_sgui = {
	scope = character
	saved_scopes = { profession }
	effect = {
		switch = {
			trigger = scope:profession
			flag:Mining = {
				change_variable = {
					name = Mining_items_made
					add = -1
				}
			}
			flag:Blacksmithing = {
				change_variable = {
					name = Blacksmithing_items_made
					add = -1
				}
			}
		}
	}
}

add_xp_sgui = {
	scope = character
	saved_scopes = { profession }
	effect = {
		switch = {
			trigger = scope:profession
			flag:Mining = {
				change_variable = {
					name = mining_xp
					add = 1
				}
				add_trait_xp = {
					trait = profession_mining
					track = mining
					value = 1
				}
			}
			flag:Blacksmithing = {
				if = {
					limit = { NOT = { has_variable = blacksmithing_xp } }
					set_variable = {
						name = blacksmithing_xp
						value = 0
					}
				}
				change_variable = {
					name = blacksmithing_xp
					add = 1	
				}
				add_trait_xp = {
					trait = profession_mining
					track = blacksmithing
					value = 1
				}
			}
		}
	}
}

pickup_ore_sgui = {
	scope = character

	effect = {
		pickup_ore_effect = yes 
	}
}