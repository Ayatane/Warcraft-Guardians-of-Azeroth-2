set_illidari_characters_effect = {
	# Give Illidari resources and set major players
	story_owner = {
		save_scope_as = illidan
	}
	character:42003 = {
		save_scope_as = kaelthas
	}
	character:330003 = {
		save_scope_as = vashj
	}
	scope:illidan = {
		add_gold = 250
		add_dread = high_dread
		add_prestige = 750
		dynasty = {
			add_dynasty_prestige_level = 3
			add_dynasty_prestige = 3000
			add_dynasty_perk = warfare_legacy_1
			add_dynasty_perk = warfare_legacy_2
		}
	}
	# NOTE: BALANCE THIS LATER
	scope:kaelthas = {
		add_gold = 250
		add_dread = high_dread
		add_prestige = 750
		dynasty = {
			add_dynasty_prestige_level = 3
			add_dynasty_prestige = 3000
			add_dynasty_perk = warfare_legacy_1
			add_dynasty_perk = warfare_legacy_2
		}
	}
	scope:vashj = {
		add_gold = 250
		add_dread = high_dread
		add_prestige = 750
		dynasty = {
			add_dynasty_prestige_level = 3
			add_dynasty_prestige = 3000
			add_dynasty_perk = warfare_legacy_1
			add_dynasty_perk = warfare_legacy_2
		}
	}
}

# Declare war on the Lich King
declare_war_on_lich_king_effect = {
	debug_log = "The Illidari have declared war on the Scourge!"
	debug_log_date = yes
	
	title:e_scourge.holder = { save_scope_as = scourge_holder }
	
	scope:illidan = {
		start_war = {
			cb = shatter_realm_cb
			target = title:e_scourge.holder
			target_title = title:e_scourge
		}		
		# trigger_event = WCHOI.6
	}
	
	every_player = {
		limit = { get_news_from_region_trigger = { REGION = world_northrend } }
		trigger_event = frozen_throne_war.2 # Notification
	}
}

try_to_set_illidari_story_owner = {
	if = {
		limit = { $OWNER$ = { culture = { has_cultural_pillar = heritage_darnassian } } }
		$OWNER$ = {
			add_character_modifier = { modifier = great_invader_modifier }
			trigger_event = { id = frozen_throne_war.10 days = 1 } #Spawns Illidari troops
		}
		make_story_owner = $OWNER$
	}
	else = {
		end_story = yes
	}
}

# Give Illidan troops
spawn_illidari_troops_effect = {
	if = {
		limit = { exists = capital_province }
		spawn_army = {
			uses_supply = no
			inheritable = no
			name = illidari_event_troops
			levies = {
				value = 1000
			}
			men_at_arms = {
				type = myrmidon
				stacks = 1
			}
			men_at_arms = {
				type = siren
				stacks = 1
			}
			men_at_arms = {
				type = spellbreaker
				stacks = 1
			}
			men_at_arms = {
				type = golem_arcane
				stacks = 2
			}
			men_at_arms = {
				type = trebuchet
				stacks = 10
			}
			location = capital_province
		}
	}
}
spawn_illidari_naga_troops_effect = {
	if = {
		limit = { exists = capital_province }
		spawn_army = {
			uses_supply = no
			inheritable = no
			name = illidari_event_troops
			levies = {
				value = 1000
			}
			men_at_arms = {
				type = myrmidon
				stacks = 3
			}
			men_at_arms = {
				type = siren
				stacks = 2
			}
			men_at_arms = {
				type = trebuchet
				stacks = 10
			}
			location = capital_province
		}
	}
}
spawn_illidari_bloodelf_troops_effect = {
	if = {
		limit = { exists = capital_province }
		spawn_army = {
			uses_supply = no
			inheritable = no
			name = illidari_event_troops
			levies = {
				value = 1000
			}
			men_at_arms = {
				type = spellbreaker
				stacks = 3
			}
			men_at_arms = {
				type = golem_arcane
				stacks = 2
			}
			men_at_arms = {
				type = trebuchet
				stacks = 10
			}
			location = capital_province
		}
	}
}

spawn_illidari_troops_based_on_culture_effect = {
	if = {
		limit = { culture = { has_innovation = innovation_naga_army } }
		spawn_illidari_naga_troops_effect = yes
	}
	else_if = {
		limit = { 
			culture = {
				OR = {
					has_innovation = innovation_golem_arcane 
					has_innovation = innovation_spellbreaker 
				}
			}
		}
		spawn_illidari_bloodelf_troops_effect = yes
	}
	else = {
		spawn_illidari_troops_effect = yes
	}
}