init_elemental_fire_spells_effect = {
	add_to_global_variable_list = { name = elemental_fire_spells target = flag:summon_fire_elemental }
}

cast_summon_fire_elemental_effect = {
	if = {
		limit = { exists = var:summon_fire_elemental_recipient }
		var:summon_fire_elemental_recipient = {
			save_scope_as = this_recipient
		}
	}
	else_if = {
		limit = { exists = var:spell_recipient }
		var:spell_recipient = {
			save_scope_as = this_recipient
		}
	}
	if = {
		limit = { 
			OR = { # current_spell_rank is for tooltips
				var:summon_fire_elemental_rank ?= 1
				AND = {
					var:current_spell_rank ?= 1	
					NOT = { is_casting_spell_trigger = { SPELL = summon_fire_elemental } }
				}
			}
		}
		scope:this_recipient = {
			add_character_modifier = {
				modifier = wc_summon_fire_elemental_modifier
				days = wc_spell_summon_fire_elemental_duration_days_value
			}
		}
	}

	else_if = {
		limit = { 
			OR = {
				AND = {
					exists = var:summon_fire_elemental_rank
					var:summon_fire_elemental_rank >= 2
				}
				AND = {
					exists = var:current_spell_rank
					var:current_spell_rank >= 2
					NOT = { is_casting_spell_trigger = { SPELL = summon_fire_elemental } }
				}
			}
		}
	}
	
	remove_variable = summon_fire_elemental_recipient
	remove_variable = summon_fire_elemental_rank
}