# Magic Lifestyle Events - Elemental
# Created by Shatterstar on 9/12/2024

# Note to future developers: 
# This file covers four lifestyles, so free to break it up into further files if needed.

namespace = elemental_fire_magic_lifestyle


#######################################
#             1000 - 1999             #
#  Elemental Lifestyle Shared Events  #
#######################################


##################################################################
# 2000 - 2999 Elemental Fire Only
##################################################################

# Playing with Fire - Your fire elementals are setting crops on fire
elemental_fire_magic_lifestyle.1201 = { 
	title = magic_lifestyle.1201.t
	desc = magic_lifestyle.1201.desc
	theme = elemental_fire

	left_portrait = { 
		character = root
		animation = steward
	}

	right_portrait = { 
		character = scope:pleading_peasant
		animation = beg
	}

	trigger = { 
		is_landed = yes
	}

	immediate = { 
		create_character = {
			location = root.capital_province
			template = generic_peasant_character
			save_scope_as = pleading_peasant
		}
	}

	# I will rein in my elemental servants
	option = { 
		name = magic_lifestyle.1201.opt.a
		add_character_modifier = { 
			modifier = reined_in_fire_elementals
			years = 3
		} 
		wc_change_amount_element_favour_effect = { ELEMENT = elemental_fire VALUE = 10 CHANGE = add }
		ai_chance = { 
			base = 25
			ai_value_modifier = {
				ai_compassion = 5
			}
		}
	}

	# My elementals shall go where they please
	option = { 
		name = magic_lifestyle.1201.opt.b
		add_character_modifier = {
			modifier = liberated_fire_elementals
			years = 3
		}
		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_boldness = 1
				ai_zeal = 1
				ai_greed = 1
			}
		}
	}

	# You dare question the spirits' will? You shall be burned alive!
	option = { 
		name = magic_lifestyle.1201.opt.c
		add_dread = minor_dread_gain
		add_piety = miniscule_piety_gain
		scope:pleading_peasant = {
			death = { 
				death_reason = death_burned_witch
				killer = root
			}
		}
		wc_change_amount_element_favour_effect = { ELEMENT = elemental_fire VALUE = 10 CHANGE = subtract }
		capital_county = {
			add_county_modifier = {
				modifier = intrigue_arbitrary_justice_modifier
				years = 2
			}
		}
		ai_chance = { 
			base = 25
			modifier = { 
				add = 200
				OR = { 
					has_trait = callous has_trait = sadistic has_trait = arbitrary 
					religion = { has_doctrine = special_doctrine_end_justifies_means }
					has_dark_government_trigger = yes
				}
			}
		}
	}

	after = { 
		hidden_effect = {
			scope:pleading_peasant = {
				if = { 
					limit = { 
						is_alive = yes 
						is_courtier = no
					}
					silent_disappearance_effect = yes
				}
			}
		}
	}
}

# Totally Stoked - Blacksmiths ask you to help improve their forges
elemental_fire_magic_lifestyle.1202 = {
	title = magic_lifestyle.1202.t
	desc = magic_lifestyle.1202.desc
	theme = elemental_fire

	trigger = { 
		is_landed = yes
	}

	immediate = { 
		create_character = {
			gender_female_chance = root_faith_dominant_gender_female_chance
			culture = root.culture
			faith = root.faith
			trait = diligent #it has a blacksmith's hammer!
			random_traits = yes
			dynasty = none
			employer = root
			save_scope_as = blacksmith
		}
		scope:blacksmith = {
			hidden_effect = {
				trigger_race_giving_no_gene_effect = yes			#Assigns race trait
			}
		}
	}

	# A fantastic idea! Take my servant, calcifer
	option = {
		trigger = {
			is_known_spell_trigger = { SPELL = flag:summon_fire_elemental }
			has_sufficient_mana_value_trigger = { VALUE = wc_spell_summon_fire_elemental_cost_mana_value }
		}
		name = magic_lifestyle.1202.opt.a
		wc_change_amount_element_favour_effect = { ELEMENT = elemental_fire VALUE = 10 CHANGE = subtract }
		wc_change_mana_by_value_effect = {
			CHANGE = subtract
			VALUE = wc_spell_summon_fire_elemental_cost_mana_value
		}
		add_character_modifier = {
			modifier = elemental_assisted_smithing
			years = 2
		}
		stress_impact = {
			greedy = miniscule_stress_gain
			arrogant = minor_stress_gain
			generous = minor_stress_loss
		}
	}

	# I shall personally assist, maybe I could learn something
	option = { 
		add_fire_elemental_magic_xp = 50
		random_list = { 
			45 = { 
				send_interface_toast = {
					title = magic_lifestyle.1202.opt.b.learn_nothing
					stress_impact = {
						base = minor_stress_gain
						arrogant = medium_stress_gain
					}
				}
			}
			50 = { 
				send_interface_toast = {
					title = magic_lifestyle.1202.opt.b.learn_something
					add_stewardship_lifestyle_xp = 100
				}
			}
			5 = { 
				modifier = { 
					add = 25
					OR = { has_trait = education_learning has_trait = education_stewardship has_trait = intellect_good has_trait = gregarious }
				}
				modifier = { 
					add = 10
					OR = { has_trait = diligent has_trait = stubborn has_trait = patient }
				}
				send_interface_toast = {
					title = magic_lifestyle.1202.opt.b.learn_alot
					add_stewardship_lifestyle_perk_points = 1
				}
			}
		}
		add_character_modifier = { 
			name = fire_magic_assisted_smithing
			years = 2
		}
		stress_impact = {
			lazy = medium_stress_gain
			arbitrary = minor_stress_gain
			impatient = minor_stress_gain
			shy = minor_stress_gain
		}
		name = magic_lifestyle.1202.opt.b
	}

	# I will not debase the elements with this busywork
	option = { 
		name = magic_lifestyle.1202.opt.c
		wc_change_amount_element_favour_effect = { ELEMENT = elemental_fire VALUE = 10 CHANGE = add }
		stress_impact = {
			generous = minor_stress_gain
			gregarious = minor_stress_loss
			lazy = minor_stress_loss
			arrogant = minor_stress_loss
		}
	}

	after = { 
		hidden_effect = {
			scope:blacksmith = {
				if = { 
					limit = { 
						is_alive = yes 
						is_courtier = no
					}
					silent_disappearance_effect = yes
				}
			}
		}
	}
}

# Fighting Fire with Fire Part 1 - Subjects ask you to use your fire elemental magic to tame a raging forest fire
elemental_fire_magic_lifestyle.1203 = { # todo: see if we can find a way to get this to fire only in summer?
	title = magic_lifestyle.1203.t
	desc = magic_lifestyle.1203.desc
	theme = elemental_fire

	trigger = { 
		any_realm_province = { 
			OR = { 
				terrain = forest
				terrain = mountain
			}
		}
	}

	immediate = {
		every_realm_province = { 
			limit = { 
				OR = { 
					terrain = forest
					terrain = mountain
				}
			}
			add_to_list = forest_fire_candidates
		}
		random_in_list = { 
			list = forest_fire_candidates
			add_province_modifier = {
				modifier = forest_fires_province_modifier
				years = 2
			} 
			save_scope_as = affected_province
		}
	}

	# i will deal with the forest fires using my elemental magic
	option = { 
		name = magic_lifestyle.1203.opt.a
		# get event 1204
	}

	# help my subjects using conventional means
	option = { 
		name = magic_lifestyle.1203.opt.b
		scope:affected_province = {
			add_province_modifier = {
				modifier = mitigated_fires_province_modifier
				years = 2
			}
		}
	}

	# do nothing
	option = { 
		name = magic_lifestyle.1203.opt.c
		random = { 
			75 = { 
				scope:affected_province = {
					add_province_modifier = {
						modifier = devastating_fires_province_modifier
						years = 2
					}
				}
			}
		}
	}
}



##################################################################
# 3000 - 3999 Elemental Water Only
##################################################################

##################################################################
# 4000 - 4999 Elemental Air Only
##################################################################

##################################################################
# 5000 - 5999 Elemental Earth Only
##################################################################